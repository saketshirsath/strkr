org: ashley7kelly
app: strkr
service: strkr
frameworkVersion: '3'

provider:
  name: aws
  region: us-east-1
  runtime: python3.8
  lambdaHashingVersion: '20201221'
  iamRoleStatements:
      - Effect: Allow
        Action:
          - rds-data:ExecuteSql
          - rds-data:ExecuteStatement
        Resource: "arn:aws:rds:us-east-1:279499514840:cluster:stkr-1"
      - Effect: Allow
        Action:
          - secretsmanager:GetSecretValue
          - secretsmanager:PutResourcePolicy
          - secretsmanager:PutSecretValue
          - secretsmanager:DeleteSecret
          - secretsmanager:DescribeSecret
          - secretsmanager:TagResource
        Resource: "arn:aws:secretsmanager:us-east-1:279499514840:secret:strk-access-LZpcd5"

functions:
  new-streak:
    handler: scripts/streaks.addStreak
    events:
      - http:
          path: /new-streak
          method: post

  get-streak-by-id:
    handler: scripts/streaks.getStreakByID
    events:
      - http:
          path: /get-streak-by-id/{id}
          method: get
  
  get-streak-by-user:
    handler: scripts/streaks.getStreakByUser
    events:
      - http:
          path: /get-streak-by-user/{id}
          method: get

  increment-streak:
    handler: scripts/streaks.incrementStreak
    events:
      - http: 
          path: /increment-streak
          method: post

  edit-streak:
    handler: scripts/streaks.editStreak
    events:
      - http: 
          path: /edit-streak
          method: post

  delete-streak:
    handler: scripts/streaks.deleteStreak
    events:
      - http: 
          path: /delete-streak/{id}
          method: get

  undo-update-streak:
    handler: scripts/streaks.undoLastUpdate
    events:
      - http: 
          path: /undo-update-streak
          method: post

  login:
    handler: scripts/userSystem.login
    events:
      - http: 
          path: /login
          method: post
  
  add-user:
    handler: scripts/userSystem.addUser
    events:
      - http: 
          path: /addUser
          method: post

  process-invite:
    handler: scripts/userSystem.processInvite
    events:
      - http: 
          path: /process-invite
          method: post

  get-user-invites:
    handler: scripts/userSystem.getUserInvites
    events:
      - http: 
          path: /get-user-invites/{id}
          method: get
    